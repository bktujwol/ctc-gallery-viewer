"use strict";class ctcOverlayViewer{constructor(a){this.addRemoveActiveGallery(this.prepareOverlay(a)),this.onRequiredEventListener()}prepareOverlay(a){var b=document.getElementById("ctcOverlayV");if(null===b){var b=document.createElement("div");b.id="ctcOverlayV",b.className="ctcOverlayV";let c=document.createElement("div");c.id="ctcOverlayImageContainerV",c.className="ctcOverlayImageContainerV";let d=document.createElement("div");d.id="ctcLoadedImgAltTitleV",d.className="ctcLoadedImgAltTitleV",c.appendChild(d);let e=document.createElement("span");e.id="ctcOverlayClosebtnV",e.className="ctcOverlayClosebtnV",e.setAttribute("title","close"),e.setAttribute("onclick","ctcOverlayViewer.closeOverlay();"),b.appendChild(e),b.appendChild(c),document.body.insertBefore(b,document.body.firstChild)}return[a,b]}static checkForUnloadedImg(a){var a=document.querySelectorAll("#ctcOverlayThumbGalleryContainerV span[data-gal-unloaded-v]");if(null!==a){var b=0,c=document.getElementById("ctcOverlayV");let d=0.045*window.screen.width;ctcOverlayViewer.objectToArray(a).map(e=>{var f=new Image;let g=f.src=e.getAttribute("data-gal-unloaded-v");f.onload=()=>{ctcOverlayViewer.loadImageAnim(5,ctcOverlayViewer.applyStyle([["display","block"],["opacity","0"],["background","url("+g+")"],["height",d+"px"]],e).removeAttribute("data-gal-unloaded-v"))},f.onerror=()=>{if(0==b){ctcOverlayV.removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0);var h=document.getElementsByClassName("ctcActiveGalleryV");h[0].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0)}b++}})}else ctcOverlayV.removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),document.getElementsByClassName("ctcActiveGalleryV").removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0)}static applyStyle(a,b){let c="";return a.map(d=>c+=d[0]+":"+d[1]+";"),b.setAttribute("style",c),b}static setElemAttr(a,b){return a.map(c=>b.setAttribute(c[0],c[1])),b}static removeElemAttr(a,b){return a.map(c=>b.removeAttribute(c)),b}static addElemClass(a,b){return a.map(c=>b.classList.add(c)),b}static removeStyle(a,b){return a.map(()=>b.style.x[0]=""),b}static removeClass(a,b){return a.map(c=>b.classList.remove(c)),b}static removeElem(a){a.map(b=>b.parentNode.removeChild(b))}static objectToArray(a){var b=[];return Object.keys(a).map(function(c){Number.isInteger(parseInt(c))&&b.push(a[c])}),b}static openCloseAnimation(a,b){if("opacity"==a[0]&&0<a[1])var c=0,d=50,e=0,f=setInterval(()=>{c>=a[1]&&0>=d&&100<=e?clearInterval(f):(c+=0.1,d-=10,e+=20,c<=a[1]&&(b.style.opacity=c),0<=d&&(b.style.top=d+"%",b.style.right=d+"%",b.style.bottom=d+"%",b.style.left=d+"%"),100>=e&&(b.style.height=e+"%",b.style.width=e+"%"))},a[2]/5,f);else var c=a[1],d=0,e=100,f=setInterval(()=>{c<=a[1]&&50===d&&0===e?clearInterval(f):(c-=0.1,d+=5,e-=10,c>=a[1]&&(b.style.opacity=c),b.style.opacity=a[1],0>=e&&(b.style.height=e+"%",b.style.width=e+"%"),50<=d&&(b.style.top=d+"%",b.style.right=d+"%",b.style.bottom=d+"%",b.style.left=d+"%"))},a[2]/5,f);return b}static loadImageAnim(a,b){b.style.opacity="0",b.style.backgroundSize="0% 0%";var c=0,d=0,e=setInterval(()=>{1<=d?clearInterval(e):(b.style.opacity=d,b.style.backgroundSize=c+"% "+c+"%"),d+=0.1,100>c&&(c+=10)},a);return b}addRemoveActiveGallery(a){if(!1===a[0].classList.contains("ctcActiveGalleryV")){var c=document.getElementById("ctcOverlayThumbGalleryContainerV");null!==c&&ctcOverlayViewer.removeElem([c]);var d=document.getElementsByClassName("ctcActiveGalleryV");if(1<=d.length){var e=["data-v-img-number","onclick"],f=ctcOverlayViewer.objectToArray(d[0].getElementsByTagName("img"));f.map(k=>ctcOverlayViewer.removeElemAttr(e,k)),ctcOverlayViewer.removeClass(["ctcActiveGalleryV"],d[0])}ctcOverlayViewer.addElemClass(["ctcActiveGalleryV"],a[0]);var g=ctcOverlayViewer.objectToArray(a[0].getElementsByTagName("img"));g.length;let j=Math.round(0.045*window.screen.width);if(2<=g.length){var h=0,c=ctcOverlayViewer.addElemClass(["ctcOverlayThumbGalleryContainerV"],document.createElement("div"));a[1].insertBefore(c,a[1].firstChild),c.id="ctcOverlayThumbGalleryContainerV",g.map(function(k,l=0){var m=new Image;m.src=k.src,ctcOverlayViewer.setElemAttr([["onclick","ctcOverlayViewer.loadOverlayImages("+l+");"]],k);m.onload=()=>{var o=[["display","block"],["background","url("+k.src+")"],["height",j+"px"]],p=[["title",k.getAttribute("title")],["alt",k.getAttribute("alt")],["onclick",k.getAttribute("onclick")]];c.appendChild(ctcOverlayViewer.setElemAttr(p,ctcOverlayViewer.applyStyle(o,document.createElement("span"))))},m.onerror=()=>{var o=[["data-gal-unloaded-v",k.src],["title",k.getAttribute("title")],["alt",k.getAttribute("alt")],["onclick",k.getAttribute("onclick")]];c.appendChild(ctcOverlayViewer.setElemAttr(o,document.createElement("span"))),h++,1==h&&(a[0].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),a[0].addEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg),a[1].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),a[1].addEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg))}})}else ctcOverlayViewer.setElemAttr([["onclick","ctcOverlayViewer.loadOverlayImages(0);"]],g[0])}return a[0]}static closeOverlay(){ctcOverlayViewer.applyStyle([["opacity",0],["width","0px"]],ctcOverlayViewer.openCloseAnimation(["opacity",0,600],ctcOverlayViewer.applyStyle([["height","0px"]],document.getElementById("ctcOverlayV")))),document.getElementById("ctcOverlayImageContainerV").style.backgroundImage="",document.body.style.overflow="auto"}static getOptimizedImageSize(a,b,c,d){var e=0,f=0,g=0,h=0;if(c>=a&&d>=b)c>=d?c>d?(f=c/a,h=c/f-0.1*a,g=d*(h/c),g>=0.9*b&&(e=b/d,g=d*e-0.1*b,h=c*(g/d))):a>b?(g=0.9*b,h=g):b>a?(h=0.9*a,g=h):(e=b/d,g=d*e-0.1*b,h=c*(g/d)):(e=d/b,g=d/e-0.1*b,h=c*(g/d));else if(c>=a&&d<b)f=a/c,h=c*f-0.1*a,g=d*(h/c);else if(d>=b&&c<a)e=b/d,g=d*e-0.1*b,h=c*(g/d),g=d*(h/c);else{var j=0.9*a,k=0.9*b;if(c>=j&&d>=k){var l=avilableWidth/c;m=avilableHeight/d,h=avilableWidth*l,g=b*e}else if(c>=j&&d<k){var l=j/c;h=c*l,g=d*(h/c)}else if(d>=k&&c<j){var m=k/d;g=d*m,h=c*(g/d)}else h=c,g=d;g=d*(h/c)}return h>0.9*a&&(h=0.9*a,g=d*(h/c)),[h,g]}static optFontSize(a){let b=120*(a/1280);return 50>b?50:70>b?70:120<b?120:b}static loadOverlayImages(a,b){document.body.style.overflow="hidden";var c=new Image;const d=parseInt(a),e=document.querySelectorAll("img[onclick=\"ctcOverlayViewer.loadOverlayImages("+a+");\"]"),f=document.getElementById("ctcOverlayV"),g=document.getElementById("ctcOverlayClosebtnV"),h=document.getElementById("ctcOverlayImageContainerV");let j=h.getAttribute("data-v-overlay-img"),k=document.querySelectorAll("span[onclick=\"ctcOverlayViewer.loadOverlayImages("+j+");\"]"),l=window.screen.width,m=window.screen.height,n=window.innerWidth,o=window.innerHeight,p=document.getElementsByClassName("ctcActiveGalleryV"),q=p[0].getElementsByTagName("img").length;if(!(0>d||q<d+1)){var r=c.src=e[0].src;(n!==l||m!==o)&&(l=n,m=o);var s=ctcOverlayViewer.getOptimizedImageSize(l,m,c.width,c.height);let t=Math.round(s[0]),u=Math.round(s[1]);0===f.offsetHeight?ctcOverlayViewer.openCloseAnimation(["opacity",1,500],ctcOverlayViewer.applyStyle([["opacity",1],["top","0"],["left","0"],["right","0"],["bottom","0"]],f)):ctcOverlayViewer.applyStyle([["opacity",1],["top","0"],["left","0"],["right","0"],["bottom","0"],["height","100%"],["width","100%"]],f);let v=ctcOverlayViewer.optFontSize(l);document.body.style.overflow="hidden",ctcOverlayViewer.addElemClass(["overlayContentloadingV"],g),c.addEventListener("load",function(){const w=document.getElementById("ctcOverlayThumbGalleryContainerV");let y=Math.round(m-u)/2,z=Math.round((u-1.6*v)/2),A=Math.round(y-g.offsetHeight/1.2),B=document.getElementById("ctcGalleryRightNavV"),C=document.getElementById("ctcGalleryLeftNavV");if(null!==B&&ctcOverlayViewer.removeElem([B]),null!==C&&ctcOverlayViewer.removeElem([C]),ctcOverlayViewer.removeClass(["overlayContentloadingV"],g),void 0!==k[0]&&ctcOverlayViewer.removeClass(["ctcOverlayThumbGalleryActiveV"],k[0]),2<=q){var D=0.045*l;"yes"===b&&ctcOverlayViewer.objectToArray(w.children).map(L=>L.style.height=D+"px");var E=w.querySelectorAll("span[onclick=\""+e[0].getAttribute("onclick")+"\"]");if(void 0!==E[0]){if(null!==E[0].getAttribute("data-gal-unloaded-v")){ctcOverlayViewer.addElemClass(["ctcOverlayThumbGalleryActiveV"],ctcOverlayViewer.removeElemAttr(["data-gal-unloaded-v"],ctcOverlayViewer.applyStyle([["display","block"],["background","url(\""+r+"\")"],["height",D+"px"],["width",D+"px"]],E[0])))}ctcOverlayViewer.addElemClass(["ctcOverlayThumbGalleryActiveV"],E[0]).scrollIntoView({behavior:"smooth",block:"center"})}q*(D+4)<m&&(null===w.firstChild?w.style.paddingTop=(m-q*(D+9))/2+"px":(w.style.paddingTop=null,w.firstChild.style.marginTop=(m-q*(D+9))/2+"px"));let I=document.getElementById("ctcOverlayCountAndCurrentImageV");null===I&&(I=document.createElement("div"),I.id="ctcOverlayCountAndCurrentImageV",I.className="ctcOverlayCountAndCurrentImageV",h.appendChild(I)),h.setAttribute("data-v-overlay-img",d);let J=Math.round(0.955*l-t)/2,K=[["opacity","0"],["background-image","url("+r+")"],["height",Math.round(u)],["width",Math.round(t)],["margin-left",J+"px"],["margin-top",y+"px"]];ctcOverlayViewer.applyStyle(K,ctcOverlayViewer.loadImageAnim(8,h)),51>v?ctcOverlayViewer.applyStyle([["margin-right",J+"px"],["margin-top",A+"px"],["font-size","35px"]],g):ctcOverlayViewer.applyStyle([["margin-right",J+"px"],["margin-top",A+"px"]],g),0<=d-1&&d+1<q?(h.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryRightNavV"],ctcOverlayViewer.setElemAttr([["title","Next Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(d+1)+");"],["id","ctcGalleryRightNavV"]],ctcOverlayViewer.applyStyle([["margin-top",z+"px"],["font-size",v+"px"]],document.createElement("span"))))),h.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryLeftNavV"],ctcOverlayViewer.setElemAttr([["title","Previous Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(d-1)+");"],["id","ctcGalleryLeftNavV"]],ctcOverlayViewer.applyStyle([["margin-top",z+"px"],["font-size",v+"px"]],document.createElement("span"))))),I.innerHTML=d+1+" of "+q):0>d-1&&d+1<q?(h.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryRightNavV"],ctcOverlayViewer.setElemAttr([["title","Next Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(d+1)+");"],["id","ctcGalleryRightNavV"]],ctcOverlayViewer.applyStyle([["margin-top",z+"px"],["font-size",v+"px"]],document.createElement("span"))))),I.innerHTML=d+1+" of "+q):0<=d-1&&d+1>=q&&(h.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryLeftNavV"],ctcOverlayViewer.setElemAttr([["title","Previous Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(d-1)+");"],["id","ctcGalleryLeftNavV"]],ctcOverlayViewer.applyStyle([["margin-top",z+"px"],["font-size",v+"px"]],document.createElement("span"))))),document.getElementById("ctcOverlayCountAndCurrentImageV").innerHTML=d+1+" of "+q)}else{let I=document.getElementById("ctcOverlayCountAndCurrentImageV");null!==I&&I.parentNode.removeChild(I),h.setAttribute("data-v-overlay-img",d);let J=Math.round((l-t)/2);ctcOverlayViewer.applyStyle([["background-image","url("+r+")"],["margin-left",J+"px"],["margin-top",y+"px"],["width",t+"px"],["height",u+"px"]],h),ctcOverlayViewer.applyStyle([["margin-right",J+"px"],["margin-top",A+"px"]],g)}let G=e[0].getAttribute("title"),H=document.getElementById("ctcLoadedImgAltTitleV");null===G?H.style.opacity="0":(H.innerHTML=G,H.style.opacity="1"),w.style.opacity="1"})}}onRequiredEventListener(){var a=document.getElementById("ctcOverlayV");window.addEventListener("resize",()=>{if(null!==a&&0!==a.offsetHeight){var b=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(b.getAttribute("data-v-overlay-img"),"yes")}}),window.addEventListener("keydown",b=>{if(0!==a.offsetHeight)if("ArrowUp"===b.code||"ArrowLeft"===b.code){let c=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(parseInt(c.getAttribute("data-v-overlay-img"))-1),b.preventDefault()}else if("ArrowDown"===b.code||"ArrowRight"==b.code){let c=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(parseInt(c.getAttribute("data-v-overlay-img"))+1),b.preventDefault()}else"Escape"==b.code&&(ctcOverlayViewer.closeOverlay(),b.preventDefault())})}}