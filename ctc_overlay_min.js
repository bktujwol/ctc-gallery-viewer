"use strict";class ctcOverlayViewer{constructor(e){this.addRemoveActiveGallery(this.prepareOverlay(e)),this.onRequiredEventListener()}prepareOverlay(e){if(null===(t=document.getElementById("ctcOverlayV"))){var t;(t=document.createElement("div")).id="ctcOverlayV",t.className="ctcOverlayV";let e=document.createElement("div");e.id="ctcOverlayImageContainerV",e.className="ctcOverlayImageContainerV";let l=document.createElement("a");l.id="ctcOverlayDownloadButtonV",l.setAttribute("target","_blank"),l.setAttribute("title","Download Image"),l.innerHTML="â‡“",e.appendChild(l);let r=document.createElement("div");r.id="ctcLoadedImgAltTitleV",r.className="ctcLoadedImgAltTitleV",e.appendChild(r);let a=document.createElement("span");a.id="ctcOverlayClosebtnV",a.className="ctcOverlayClosebtnV",a.setAttribute("title","close"),a.setAttribute("onclick","ctcOverlayViewer.closeOverlay();"),t.appendChild(a),t.appendChild(e),document.body.insertBefore(t,document.body.firstChild)}return[e,t]}static checkForUnloadedImg(e){if(null!==(e=document.querySelectorAll("#ctcOverlayThumbGalleryContainerV span[data-gal-unloaded-v]"))){var t=0;document.getElementById("ctcOverlayV");let l=.045*window.screen.width;ctcOverlayViewer.objectToArray(e).map(e=>{var r=new Image;let a=r.src=e.getAttribute("data-gal-unloaded-v");r.decode().then(()=>{var t=[["display","block"],["background","url("+a+")"],["height",l+"px"]];ctcOverlayViewer.applyStyle(t,e).removeAttribute("data-gal-unloaded-v")}).catch(()=>{0===t&&(ctcOverlayV.removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),document.getElementsByClassName("ctcActiveGalleryV")[0].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0));t++})})}else ctcOverlayV.removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),document.getElementsByClassName("ctcActiveGalleryV").removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0)}static applyStyle(e,t){let l="";return e.map(e=>l+=e[0]+":"+e[1]+";"),t.setAttribute("style",l),t}static setElemAttr(e,t){return e.map(e=>t.setAttribute(e[0],e[1])),t}static removeElemAttr(e,t){return e.map(e=>t.removeAttribute(e)),t}static addElemClass(e,t){return e.map(e=>t.classList.add(e)),t}static removeStyle(e,t){return e.map(e=>t.style.x[0]=""),t}static removeClass(e,t){return e.map(e=>t.classList.remove(e)),t}static removeElem(e){e.map(e=>e.parentNode.removeChild(e))}static objectToArray(e){var t=[];return Object.keys(e).map(function(l){Number.isInteger(parseInt(l))&&t.push(e[l])}),t}static openCloseAnimation(e,t){if("opacity"==e[0]&&e[1]>0)var l=0,r=50,a=0,c=setInterval(()=>{l>=e[1]&&r<=0&&a>=100?clearInterval(c):(r-=10,a+=20,(l+=.1)<=e[1]&&(t.style.opacity=l),r>=0&&(t.style.top=r+"%",t.style.right=r+"%",t.style.bottom=r+"%",t.style.left=r+"%"),a<=100&&(t.style.height=a+"%",t.style.width=a+"%"))},e[2]/5,c);else l=e[1],r=0,a=100,c=setInterval(()=>{l<=e[1]&&50===r&&0===a?clearInterval(c):(r+=5,a-=10,(l-=.1)>=e[1]&&(t.style.opacity=l),t.style.opacity=e[1],a<=0&&(t.style.height=a+"%",t.style.width=a+"%"),r>=50&&(t.style.top=r+"%",t.style.right=r+"%",t.style.bottom=r+"%",t.style.left=r+"%"))},e[2]/5,c);return t}addRemoveActiveGallery(e){if(!1===e[0].classList.contains("ctcActiveGalleryV")){null!==(c=document.getElementById("ctcOverlayThumbGalleryContainerV"))&&ctcOverlayViewer.removeElem([c]);var t=document.getElementsByClassName("ctcActiveGalleryV");if(t.length>=1){var l=["data-v-img-number","onclick"];ctcOverlayViewer.objectToArray(t[0].getElementsByTagName("img")).map(e=>ctcOverlayViewer.removeElemAttr(l,e)),ctcOverlayViewer.removeClass(["ctcActiveGalleryV"],t[0])}ctcOverlayViewer.addElemClass(["ctcActiveGalleryV"],e[0]);var r=ctcOverlayViewer.objectToArray(e[0].getElementsByTagName("img"));r.length;let i=Math.round(.045*window.screen.width);if(r.length>=2){var a=0,c=ctcOverlayViewer.addElemClass(["ctcOverlayThumbGalleryContainerV"],document.createElement("div"));e[1].insertBefore(c,e[1].firstChild),c.id="ctcOverlayThumbGalleryContainerV",r.map(function(t,l=0){var r=new Image;r.src=t.src,ctcOverlayViewer.setElemAttr([["onclick","ctcOverlayViewer.loadOverlayImages("+l+");"]],t);r.decode().then(()=>{var e=[["display","block"],["background","url("+t.src+")"],["height",i+"px"]],l=[["title",t.getAttribute("title")],["alt",t.getAttribute("alt")],["onclick",t.getAttribute("onclick")]];c.appendChild(ctcOverlayViewer.setElemAttr(l,ctcOverlayViewer.applyStyle(e,document.createElement("span"))))}).catch(l=>{var r=[["data-gal-unloaded-v",t.src],["title",t.getAttribute("title")],["alt",t.getAttribute("alt")],["onclick",t.getAttribute("onclick")]];c.appendChild(ctcOverlayViewer.setElemAttr(r,document.createElement("span"))),1===++a&&(e[0].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),e[0].addEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg),e[1].removeEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg,!0),e[1].addEventListener("mouseover",ctcOverlayViewer.checkForUnloadedImg))})})}else ctcOverlayViewer.setElemAttr([["onclick","ctcOverlayViewer.loadOverlayImages(0);"]],r[0])}return e[0]}static closeOverlay(){ctcOverlayViewer.applyStyle([["opacity",0],["width","0px"]],ctcOverlayViewer.openCloseAnimation(["opacity",0,600],ctcOverlayViewer.applyStyle([["height","0px"]],document.getElementById("ctcOverlayV")))),document.getElementById("ctcOverlayImageContainerV").style.backgroundImage="",document.body.style.overflow="auto"}static getOptimizedImageSize(e,t,l,r){var a=0,c=0,i=0;if(l>=e&&r>=t)l>=r?l>r?(c=r*((i=l/(l/e)-.1*e)/l))>=.9*t&&(i=l*((c=r*(a=t/r)-.1*t)/r)):e>t?i=c=.9*t:t>e?c=i=.9*e:i=l*((c=r*(a=t/r)-.1*t)/r):i=l*((c=r/(a=r/t)-.1*t)/r);else if(l>=e&&r<t)c=r*((i=l*(e/l)-.1*e)/l);else if(r>=t&&l<e)c=r*((i=l*((c=r*(a=t/r)-.1*t)/r))/l);else{var n=.9*e,o=.9*t;if(l>=n&&r>=o){var d=avilableWidth/l;y=avilableHeight/r,i=avilableWidth*d,c=t*a}else if(l>=n&&r<o){c=r*((i=l*(d=n/l))/l)}else if(r>=o&&l<n){var y=o/r;i=l*((c=r*y)/r)}else i=l,c=r;c=r*(i/l)}return i>.9*e&&(c=r*((i=.9*e)/l)),[i,c]}static optFontSize(e){let t=e/1280*120;return t<50?50:t<70?70:t>120?120:t}static loadOverlayImages(e,t){document.body.style.overflow="hidden";var l=new Image;const r=parseInt(e),a=document.querySelectorAll('img[onclick="ctcOverlayViewer.loadOverlayImages('+e+');"]'),c=document.getElementById("ctcOverlayV"),i=document.getElementById("ctcOverlayClosebtnV"),n=document.getElementById("ctcOverlayThumbGalleryContainerV"),o=document.getElementById("ctcOverlayImageContainerV");let d=o.getAttribute("data-v-overlay-img"),y=document.querySelectorAll('span[onclick="ctcOverlayViewer.loadOverlayImages('+d+');"]'),m=window.screen.width,v=window.screen.height,s=window.innerWidth,g=window.innerHeight,u=document.getElementsByClassName("ctcActiveGalleryV")[0].getElementsByTagName("img").length;if(r<0||u<r+1)return;var p=l.src=a[0].src;s===m&&v===g||(m=s,v=g);var V=ctcOverlayViewer.getOptimizedImageSize(m,v,l.width,l.height);let O=Math.round(V[0]),h=Math.round(V[1]);0===c.offsetHeight?ctcOverlayViewer.openCloseAnimation(["opacity",1,500],ctcOverlayViewer.applyStyle([["opacity",1],["top","0"],["left","0"],["right","0"],["bottom","0"]],c)):ctcOverlayViewer.applyStyle([["opacity",1],["top","0"],["left","0"],["right","0"],["bottom","0"],["height","100%"],["width","100%"]],c);let w=ctcOverlayViewer.optFontSize(m);document.body.style.overflow="hidden",ctcOverlayViewer.addElemClass(["overlayContentloadingV"],i),l.addEventListener("load",function(){let e=Math.round(v-h)/2,l=Math.round((h-1.6*w)/2),c=Math.round(e-i.offsetHeight/1.2),d=document.getElementById("ctcGalleryRightNavV"),s=document.getElementById("ctcGalleryLeftNavV");if(null!==d&&ctcOverlayViewer.removeElem([d]),null!==s&&ctcOverlayViewer.removeElem([s]),ctcOverlayViewer.removeClass(["overlayContentloadingV"],i),void 0!==y[0]&&ctcOverlayViewer.removeClass(["ctcOverlayThumbGalleryActiveV"],y[0]),u>=2){var g=.045*m;"yes"===t&&(console.log(ctcOverlayViewer.objectToArray(n.children)),ctcOverlayViewer.objectToArray(n.children).map(e=>e.style.height=g+"px"));var V=n.querySelectorAll('span[onclick="'+a[0].getAttribute("onclick")+'"]');if(V[0].scrollIntoView({behavior:"smooth",block:"center"}),void 0!==V[0]&&null!==V[0].getAttribute("data-gal-unloaded-v")){var E=[["display","block"],["background",'url("'+p+'")'],["height",g+"px"],["width",g+"px"]];ctcOverlayViewer.addElemClass(["ctcOverlayThumbGalleryActiveV"],ctcOverlayViewer.removeElemAttr(["data-gal-unloaded-v"],ctcOverlayViewer.applyStyle(E,V[0]))),u*(g+4)<v&&(n.firstChild.style.marginTop=(v-u*(g+9))/2+"px")}else void 0!==V[0]&&(V[0].classList.add("ctcOverlayThumbGalleryActiveV"),u*(g+4)<v&&(n.firstChild.style.marginTop=(v-u*(g+9))/2+"px"));let d=document.getElementById("ctcOverlayCountAndCurrentImageV");null===d&&((d=document.createElement("div")).id="ctcOverlayCountAndCurrentImageV",d.className="ctcOverlayCountAndCurrentImageV",o.appendChild(d)),o.setAttribute("data-v-overlay-img",r);let y=Math.round(.955*m-O)/2,s=[["background-image","url("+p+")"],["margin-left",y+"px"],["margin-top",e+"px"],["width",Math.round(O)+"px"],["height",Math.round(h)+"px"]];ctcOverlayViewer.applyStyle(s,o),w<51?ctcOverlayViewer.applyStyle([["margin-right",y+"px"],["margin-top",c+"px"],["font-size","35px"]],i):ctcOverlayViewer.applyStyle([["margin-right",y+"px"],["margin-top",c+"px"]],i),r-1>=0&&r+1<u?(o.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryRightNavV"],ctcOverlayViewer.setElemAttr([["title","Next Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(r+1)+");"],["id","ctcGalleryRightNavV"]],ctcOverlayViewer.applyStyle([["margin-top",l+"px"],["font-size",w+"px"]],document.createElement("span"))))),o.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryLeftNavV"],ctcOverlayViewer.setElemAttr([["title","Previous Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(r-1)+");"],["id","ctcGalleryLeftNavV"]],ctcOverlayViewer.applyStyle([["margin-top",l+"px"],["font-size",w+"px"]],document.createElement("span"))))),d.innerHTML=r+1+" of "+u):r-1<0&&r+1<u?(o.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryRightNavV"],ctcOverlayViewer.setElemAttr([["title","Next Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(r+1)+");"],["id","ctcGalleryRightNavV"]],ctcOverlayViewer.applyStyle([["margin-top",l+"px"],["font-size",w+"px"]],document.createElement("span"))))),d.innerHTML="Image "+(r+1)+" of "+u):r-1>=0&&r+1>=u&&(o.appendChild(ctcOverlayViewer.addElemClass(["ctcGalleryLeftNavV"],ctcOverlayViewer.setElemAttr([["title","Previous Image"],["onclick","ctcOverlayViewer.loadOverlayImages("+(r-1)+");"],["id","ctcGalleryLeftNavV"]],ctcOverlayViewer.applyStyle([["margin-top",l+"px"],["font-size",w+"px"]],document.createElement("span"))))),document.getElementById("ctcOverlayCountAndCurrentImageV").innerHTML="Image "+(r+1)+" of "+u)}else{let t=document.getElementById("ctcOverlayCountAndCurrentImageV");null!==t&&t.parentNode.removeChild(t),o.setAttribute("data-v-overlay-img",r);let l=Math.round((m-O)/2);ctcOverlayViewer.applyStyle([["background-image","url("+p+")"],["margin-left",l+"px"],["margin-top",e+"px"],["width",O+"px"],["height",h+"px"]],o),ctcOverlayViewer.applyStyle([["margin-right",l+"px"],["margin-top",c+"px"]],i)}let I=a[0].getAttribute("title"),A=document.getElementById("ctcLoadedImgAltTitleV");null!==I?(A.innerHTML=I,A.style.opacity="1"):A.style.opacity="0"}),document.getElementById("ctcOverlayDownloadButtonV").setAttribute("href",p),n.style.opacity="1"}onRequiredEventListener(){var e=document.getElementById("ctcOverlayV");window.addEventListener("resize",()=>{if(null!==e&&0!==e.offsetHeight){var t=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(t.getAttribute("data-v-overlay-img"),"yes")}}),window.addEventListener("keydown",t=>{if(0!==e.offsetHeight)if("ArrowUp"===t.code||"ArrowLeft"===t.code){let e=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(parseInt(e.getAttribute("data-v-overlay-img"))-1),t.preventDefault()}else if("ArrowDown"===t.code||"ArrowRight"==t.code){let e=document.getElementById("ctcOverlayImageContainerV");ctcOverlayViewer.loadOverlayImages(parseInt(e.getAttribute("data-v-overlay-img"))+1),t.preventDefault()}else"Escape"==t.code&&(ctcOverlayViewer.closeOverlay(),t.preventDefault())})}}